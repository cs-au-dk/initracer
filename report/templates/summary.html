<h3>InitRacer Summary</h3>

<button type="button" class="btn" style="height: 50px; width: 250px" ng-click="$location.path('access-before-definition')">
    Access-Before-Definition Warnings
</button>
<button type="button" class="btn" style="height: 50px; width: 300px" ng-click="$location.path('late-event-handler-registration')">
    Late-Event-Handler-Registration Warnings
</button>
<button type="button" class="btn" style="height: 50px; width: 280px" ng-click="$location.path('form-input-overwritten')">
    Form-Input-Overwritten Warnings
</button>
<button type="button" class="btn" style="height: 50px; width: 250px" ng-click="$location.path('performance')">
    Performance
</button>

<div style="margin: 2em 0 0 2em">
    <h4>RQ1: Number of Reported Warnings</h4>

    <p>Table 1 (below) shows the number of warnings generated by InitRacer, in each of the three categories. The columns in this table show, for each website,<sup>1</sup> the number of form-input-overwritten (FIO) warnings, late-event-handler-registration (LEHR) warnings, and access-before-definition (ABD) warnings. For LEHR and ABD, we further distinguish between user and system event handler registrations.</p>

    <p>
        <b>FIO</b> As can be seen from the ‘<b>Total</b>’ row of the table, InitRacer finds a total of
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'validated']) + (sites | sumOfValue: ['formInputOverwrittenRaces', 'blurs', 'visibleWritableStaticTargetWithLongDelay']) }}
            </span>
        FIO warnings due to matches with pattern <b>P</b><sub>1</sub>'.<sup>2</sup> Without the check for form field values changes,
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'visibleWritableStaticTargetWithLongDelay']) - (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'validated']) }}
            </span>
        additional warnings would have been reported.
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'validated']) }}
            </span>
        of the
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'validated']) + (sites | sumOfValue: ['formInputOverwrittenRaces', 'blurs', 'visibleWritableStaticTargetWithLongDelay']) }}
            </span>
        warnings are due to write-form-field and
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'blurs', 'visibleWritableStaticTargetWithLongDelay']) }}
            </span>
        are due to focus.
    </p>

    <p>
        <b>LEHR</b> InitRacer reports a total of
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'user', 'visibleStaticTargetWithLongDelayWithPreventDefault']) + (sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'system', 'staticElementTargetWithLongDelay']) }}
            </span>
        LEHR warnings due to matches with pattern <b>P</b><sub>1</sub>',<sup>3</sup> thereof
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'user', 'visibleStaticTargetWithLongDelayWithPreventDefault']) }}
            </span>
        involving user event handlers, and
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'system', 'staticElementTargetWithLongDelay']) }}
            </span>
        involving system event handlers.
    </p>

    <p>
        <b>ABD</b> The
            <span style="color: blue; font-weight: bold">
                {{ sites.length }}
            </span>
        &tau;<sub>a</sub>-traces collected by InitRacer gives rise to
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'validated']) + (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated']) }}
            </span>
        matches with <b>P</b><sub>3a</sub> that can be validated by injecting only a single event handler. Of these,
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'validated']) }}
            </span>
        involve user event handlers and
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated']) }}
            </span>
        involve system event handlers. Without the validation phase,
            <span style="color: blue; font-weight: bold">
                {{ ((sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'failing']) + (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'failing'])) - ((sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'validated']) + (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated'])) }}
            </span>
        additional warnings (possible due to interference) would have been reported. Of the
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'validated']) + (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated']) }}
            </span>
        validated warnings,
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'initializationErrors']) }}
            </span>
        user event handlers only crash during initialization (i.e., the corresponding trace &tau;<sub>b</sub> from validation mode does not match <b>P</b><sub>3b</sub>).
        <span ng-switch="(sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'initializationErrors']).toString()">
            <span ng-switch-when="0">
                InitRacer was unable to confirm that the
                    <span style="color: blue; font-weight: bold">
                        {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated']) }}
                    </span>
                system event handlers do not crash after initialization.
            </span>
            <span ng-switch-default>
                Of the
                    <span style="color: blue; font-weight: bold">
                        {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated']) }}
                    </span>
                system event handlers,
                    <span style="color: blue; font-weight: bold">
                        {{ (sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'initializationErrors']) }}
                    </span>
                only crash during initialization.
            </span>
        </span>
        
        In fact, on
            <span style="color: blue; font-weight: bold">
                {{ sites.filter(siteOnlyHasValidatedABDWarnings).length }}
            </span>
        of the
            <span style="color: blue; font-weight: bold">
                {{ sites.filter(siteHasNonValidatedABDWarning).length }}
            </span>
        websites that have at least one ABD warning, InitRacer is able to validate <i>all</i> crashing user and system event handlers.
    </p>

    <p>
        <small><sup>1</sup>InitRacer does not report any warnings for
            <span style="color: blue; font-weight: bold">
                {{ sites.length-sites.filter(siteHasWarning).length }}
            </span>
        of the
            <span style="color: blue; font-weight: bold">
                {{ sites.length }}
            </span>
        websites.</small>
    </p>

    <p>
        <small><sup>2</sup>The less precise race pattern <b>P</b><sub>1</sub>, reports
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'visibleWritableStaticTarget']) - (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'visibleWritableStaticTargetWithLongDelay']) }}
            </span>
        additional write-form-field warnings, suggesting that most issues do involve a long delay. The long delay requirement in <b>P</b><sub>1</sub>' is still useful because, without it, a race detector may report a warning efter <i>after</i> the error has been fixed.</small>
    </p>

    <p>
        <small><sup>3</sup>Using the less precise pattern <b>P</b><sub>2</sub>, which does not take into account long delays or whether a registered user event handler calls preventDefault, leads to an overwhelming increase in the number of warnings:
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'user', 'visibleStaticTarget']) }}
            </span>
        and
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'system', 'staticElementTarget']) }}
            </span>
        for user and system event handler registrations, respectively.</small>
    </p>

    <h4>RQ2: Performance</h4>

    <p>
        In InitRacer's observation phase and adverse phase, the instrumented web page is loaded just once. Although this is significantly slower compared to loading the origin web page (mostly due to instrumentation overhead and taking screenshots) this can be done in
            <span style="color: blue; font-weight: bold">
                {{ Math.min((sites | sumOfValue: { path: ['info', 'timing', 'observation'], computation: 'min' }), (sites | sumOfValue: { path: ['info', 'timing', 'adverse'], computation: 'min' })) | duration: 'mm:ss' }}
            </span>
        to
            <span style="color: blue; font-weight: bold">
                {{ Math.max((sites | sumOfValue: { path: ['info', 'timing', 'observation'], computation: 'max' }), (sites | sumOfValue: { path: ['info', 'timing', 'adverse'], computation: 'max' })) | duration: 'mm:ss' }}
            </span>
        seconds depending on the web page
            (<span style="color: blue; font-weight: bold">{{
                ((sites | sumOfValue: { path: ['info', 'timing', 'observation'], average: true, round: true }) + (sites | sumOfValue: { path: ['info', 'timing', 'adverse'], average: true, round: true }) / 2) | duration: 'hh:mm:ss'
            }}</span>
        seconds on average).
    </p>

    <p>
        In the validation phase, InitRacer loads the web page once for each ABD warning. On average, this takes around
            <span style="color: blue; font-weight: bold">
                {{ (sites | sumOfValue: { path: ['info', 'timing', 'validation'], average: true, round: true }) | duration: 'hh:mm:ss' }}
            </span>
        minutes per website with at least one ABD warning
            (<span style="color: blue; font-weight: bold">{{
                siteWithMostABDWarnings().info.timing.validation | duration: 'hh:mm:ss'
            }}</span>
        minutes for
            <span style="color: blue; font-weight: bold">{{
                siteWithMostABDWarnings().name
            }}</span>,
        which has the most ABD warnings), while it is free for the remaining
            <span style="color: blue; font-weight: bold">
                {{ sites.length-sites.filter(siteHasNonValidatedABDWarning).length }}
            </span>
        websites.
    </p>

    <h4>Table 1: Results</h4>

    <table class="table table-condensed table-hover table-striped" style="width: auto">
        <thead>
            <tr>
                <th rowspan="2">Website</th>
                <th rowspan="2">FIO</th>
                <th colspan="2">LEHR</th>
                <th colspan="2">ABD</th>
                <th rowspan="2" style="width: 100%"></th>
            </tr>
            <tr>
                <th>User</th>
                <th>Sys.</th>
                <th>User</th>
                <th>Sys.</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="site in sites | orderBy:'name'">
                <td style="white-space: nowrap">
                    <strong>
                        <a href="#/{{site.name}}/">{{site.name}}</a>
                    </strong>
                </td>
                <td class="bl centered">
                    {{site.formInputOverwrittenRaces.writes.validated + site.formInputOverwrittenRaces.blurs.visibleWritableStaticTargetWithLongDelay}}
                </td>
                <td class="bl centered">
                    {{site.lateEventHandlerRegistrationRaces.user.visibleStaticTargetWithLongDelayWithPreventDefault}}
                </td>
                <td class="centered">
                    {{site.lateEventHandlerRegistrationRaces.system.staticElementTargetWithLongDelay}}
                </td>
                <td class="bl centered">
                    {{site.accessBeforeDefinitionRaces.user.validated}}
                </td>
                <td class="centered">
                    {{site.accessBeforeDefinitionRaces.system.validated}}
                </td>
                <td class="bl"></td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <th>Total</th>
                <th class="bl centered">
                    {{ (sites | sumOfValue: ['formInputOverwrittenRaces', 'writes', 'validated']) + (sites | sumOfValue: ['formInputOverwrittenRaces', 'blurs', 'visibleWritableStaticTargetWithLongDelay']) }}
                </th>
                <th class="bl centered">
                    {{ sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'user', 'visibleStaticTargetWithLongDelayWithPreventDefault'] }}
                </th>
                <th class="centered">
                    {{ sites | sumOfValue: ['lateEventHandlerRegistrationRaces', 'system', 'staticElementTargetWithLongDelay'] }}
                </th>
                <th class="bl centered">
                    {{ sites | sumOfValue: ['accessBeforeDefinitionRaces', 'user', 'validated'] }}
                </th>
                <th class="centered">
                    {{ sites | sumOfValue: ['accessBeforeDefinitionRaces', 'system', 'validated'] }}
                </th>
                <th class="bl"></th>
            </tr>
        </tfoot>
    </table>
</div>
